DROP TABLE ADMIN CASCADE CONSTRAINTS;
DROP TABLE BOOK CASCADE CONSTRAINTS;
DROP TABLE Subscription CASCADE CONSTRAINTS;
DROP TABLE Novel CASCADE CONSTRAINTS;
DROP TABLE MEMBER CASCADE CONSTRAINTS;
DROP TABLE Genre CASCADE CONSTRAINTS;
DROP TABLE MEMBERJOINGENRE CASCADE CONSTRAINTS;
DROP TABLE GRADE CASCADE CONSTRAINTS;
DROP TABLE Shipment CASCADE CONSTRAINTS;
DROP TABLE REVIEW_SNS CASCADE CONSTRAINTS;
DROP TABLE comment_TABLE CASCADE CONSTRAINTS;
DROP TABLE Favorite CASCADE CONSTRAINTS;
DROP TABLE Score CASCADE CONSTRAINTS;
DROP TABLE Episode CASCADE CONSTRAINTS;
DROP TABLE LIKE_TABLE CASCADE CONSTRAINTS;
DROP TABLE category;
DROP TABLE QnA CASCADE CONSTRAINTS;

CREATE TABLE ADMIN (
 adminId VARCHAR2(100) PRIMARY KEY,
 adminPw VARCHAR2(100) NOT NULL
);

CREATE TABLE QnA (
   qnaNo   NUMBER   NOT NULL,
   memberNo   NUMBER   NOT NULL,
   qnaTitle   VARCHAR2(100)   NOT NULL,
   qnaContent   VARCHAR2(150)   NOT NULL,
   writeDate   VARCHAR2(100)   NOT NULL,
   hit   NUMBER   NOT NULL
);


CREATE TABLE BOOK (
 bookNo NUMBER PRIMARY KEY,
 genreNo NUMBER NOT NULL,
 bookName VARCHAR2(300) NOT NULL,
 bookWriter VARCHAR2(100) NOT NULL,
 bookPublisher VARCHAR2(300) NOT NULL,
 publishingYear VARCHAR2(100) NOT NULL,
 bookContent VARCHAR2(2000) NOT NULL,
 grade NUMBER NULL
);

CREATE TABLE Subscription (
 subNo NUMBER PRIMARY KEY,
 memberNo NUMBER NOT NULL,
 subDate VARCHAR2(300) NOT NULL,
 subName VARCHAR2(100) NOT NULL,
 subTel VARCHAR2(100) NOT NULL,
 subTerm VARCHAR2(300) NOT NULL,
 subPay VARCHAR2(300) NOT NULL,
 postCode VARCHAR2(100) NOT NULL,
 roadAddress VARCHAR2(100) NOT NULL,
 jibunAddress VARCHAR2(100) NOT NULL,
 detailAddress VARCHAR2(100),
 extraAddress VARCHAR2(100)
);

CREATE TABLE Novel (
 novelNo NUMBER PRIMARY KEY,
 memberNo NUMBER NOT NULL,
 title VARCHAR2(100) NOT NULL,
 discription VARCHAR2(150) NOT NULL,
 addDate VARCHAR2(100) DEFAULT to_char(sysdate,'yyyy/mm/dd hh24:mi:ss'),
 category NUMBER NOT NULL,
 imgOriginName VARCHAR2(150),
 imgStoredName VARCHAR2(200)
);

CREATE TABLE category (
	categoryNo NUMBER PRIMARY KEY,
	categoryName VARCHAR2(50) NOT NULL
);

CREATE TABLE MEMBER (
memberNo NUMBER PRIMARY KEY,
memberId VARCHAR2(200) NOT NULL,
memberName VARCHAR2(100) NOT NULL,
memberNick VARCHAR2(150) NOT NULL,
memberPw VARCHAR2(100) NOT NULL,
memberBirth NUMBER NOT NULL,
memberTel VARCHAR2(100) NOT NULL,
memberGender VARCHAR2(100) NOT NULL,
genre VARCHAR2(150) NOT NULL,
subcheck VARCHAR2(100) NOT NULL,
postcode VARCHAR2(100) NOT NULL,
roadaddress VARCHAR2(100) NOT NULL,
jibunaddress VARCHAR2(100) NOT NULL,
detailaddress VARCHAR2(100),
extraaddress VARCHAR2(100)
);

CREATE TABLE Genre (
 genreNo NUMBER PRIMARY KEY,
 genreName VARCHAR2(50) NOT NULL
);

CREATE TABLE GRADE (
 grade NUMBER PRIMARY KEY,
 memberNo NUMBER NOT NULL,
 bookNo NUMBER NOT NULL
);

CREATE TABLE MEMBERJOINGENRE (
 memberNo NUMBER NOT NULL,
 genreNo NUMBER NOT NULL
);

CREATE TABLE Shipment (
 shipNo NUMBER PRIMARY KEY,
 shipmentDate VARCHAR2(300) NOT NULL,
 memberNo NUMBER NOT NULL,
 bookNo NUMBER NOT NULL,
 subNo NUMBER NOT NULL
);

CREATE TABLE LIKE_TABLE (
 memberNo NUMBER NOT NULL,
 feedNo NUMBER NOT NULL
);

CREATE TABLE REVIEW_SNS (
 feedNo NUMBER PRIMARY KEY,
 memberNo NUMBER NOT NULL,
 bookNo NUMBER NOT NULL,
 review VARCHAR2(500) NOT NULL,
 privacy NUMBER NULL,
 reviewDate VARCHAR2(100) DEFAULT to_char(sysdate,'yyyy/mm/dd hh24:mi:ss')
);

CREATE TABLE Episode (
 episodeNo NUMBER PRIMARY KEY,
 novelNo NUMBER NOT NULL,
 title VARCHAR2(100) NOT NULL,
 content VARCHAR2(4000) NOT NULL,
 score NUMBER NULL,
 addDate VARCHAR2(100) DEFAULT to_char(sysdate,'yyyy/mm/dd hh24:mi:ss')
);

CREATE TABLE comment_TABLE (
 commentNo NUMBER PRIMARY KEY,
 episodeNo NUMBER NOT NULL,
 memberNo NUMBER NOT NULL,
 content VARCHAR2(300) NOT NULL,
 addDate VARCHAR2(100) NOT NULL,
 parentCmtNo int DEFAULT 0,
 seq int DEFAULT 1
);

CREATE TABLE Favorite (
 memberNo NUMBER NOT NULL,
 novelNo NUMBER NOT NULL
);

CREATE TABLE Score (
 memberNo NUMBER NOT NULL,
 episodeNo NUMBER NOT NULL,
 score NUMBER NOT NULL
);

-------------------------------------------------------------


ALTER TABLE BOOK ADD CONSTRAINT FK_Genre_TO_BOOK_1 FOREIGN KEY (
 genreNo
)
REFERENCES Genre (
 genreNo
);

ALTER TABLE Novel ADD CONSTRAINT FK_MEMBER_TO_Novel_1 FOREIGN KEY (
 memberNo
)
REFERENCES MEMBER (
 memberNo
) ON DELETE CASCADE;

ALTER TABLE Novel ADD CONSTRAINT FK_CATEGORY_TO_Novel_1 FOREIGN KEY (
 category
)
REFERENCES CATEGORY (
 categoryNo
);

ALTER TABLE GRADE ADD CONSTRAINT FK_MEMBER_TO_GRADE_1 FOREIGN KEY (
 memberNo
)
REFERENCES MEMBER (
 memberNo
);

ALTER TABLE GRADE ADD CONSTRAINT FK_BOOK_TO_GRADE_1 FOREIGN KEY (
 bookNo
)
REFERENCES BOOK (
 bookNo
);

ALTER TABLE MEMBERJOINGENRE ADD CONSTRAINT FK_MEMBER_TO_MEMBERJOINGENRE_1 FOREIGN KEY (
 memberNo
)
REFERENCES MEMBER (
 memberNo
);

ALTER TABLE MEMBERJOINGENRE ADD CONSTRAINT FK_Genre_TO_MEMBERJOINGENRE_1 FOREIGN KEY (
 genreNo
)
REFERENCES Genre (
 genreNo
);

ALTER TABLE Shipment ADD CONSTRAINT FK_Subscription_TO_Shipment_1 FOREIGN KEY (
 subNo
)
REFERENCES Subscription (
 subNo
);

ALTER TABLE Shipment ADD CONSTRAINT FK_BOOK_TO_Shipment_1 FOREIGN KEY (
 bookNo
)
REFERENCES Book (
 bookNo
);

ALTER TABLE LIKE_TABLE ADD CONSTRAINT FK_MEMBER_TO_LIKE_TABLE_1 FOREIGN KEY (
 memberNo
)
REFERENCES MEMBER (
 memberNo
);

ALTER TABLE LIKE_TABLE ADD CONSTRAINT FK_REVIEW_SNS_TO_LIKE_TABLE_1 FOREIGN KEY (
 feedNo
)
REFERENCES REVIEW_SNS (
 feedNo
);

ALTER TABLE REVIEW_SNS ADD CONSTRAINT FK_MEMBER_TO_REVIEW_SNS_1 FOREIGN KEY (
 memberNo
)
REFERENCES MEMBER (
 memberNo
);

ALTER TABLE REVIEW_SNS ADD CONSTRAINT FK_BOOK_TO_REVIEW_SNS_1 FOREIGN KEY (
 bookNo
)
REFERENCES BOOK (
 bookNo
);

ALTER TABLE Episode ADD CONSTRAINT FK_Novel_TO_Episode_1 FOREIGN KEY (
 novelNo
)
REFERENCES Novel (
 novelNo
) on DELETE CASCADE;

ALTER TABLE comment_TABLE ADD CONSTRAINT FK_MEMBER_TO_comment_TABLE_1 FOREIGN KEY (
 memberNo
)
REFERENCES MEMBER (
 memberNo
) ON DELETE CASCADE;

ALTER TABLE comment_TABLE ADD CONSTRAINT FK_EPISODE_TO_comment_TABLE_1 FOREIGN KEY (
 episodeNo
)
REFERENCES EPISODE (
 episodeNo
) ON DELETE CASCADE;

ALTER TABLE Favorite ADD CONSTRAINT FK_MEMBER_TO_Favorite_1 FOREIGN KEY (
 memberNo
)
REFERENCES MEMBER (
 memberNo
);

ALTER TABLE Favorite ADD CONSTRAINT FK_Novel_TO_Favorite_1 FOREIGN KEY (
 novelNo
)
REFERENCES Novel (
 novelNo
) on DELETE CASCADE;

ALTER TABLE Score ADD CONSTRAINT FK_MEMBER_TO_Score_1 FOREIGN KEY (
 memberNo
)
REFERENCES MEMBER (
 memberNo
);

ALTER TABLE Score ADD CONSTRAINT FK_Episode_TO_Score_1 FOREIGN KEY (
 episodeNo
)
REFERENCES Episode (
 episodeNo
) on DELETE CASCADE;

ALTER TABLE QnA ADD CONSTRAINT FK_MEMBER_TO_QnA_1 FOREIGN KEY (
   memberNo
)
REFERENCES MEMBER (
   memberNo
) on DELETE CASCADE;

DROP SEQUENCE book_seq;
DROP SEQUENCE review_sns_seq;
DROP SEQUENCE member_seq;
DROP SEQUENCE subscription_seq;
DROP SEQUENCE shipment_seq;
DROP SEQUENCE comment_table_seq;
DROP SEQUENCE novel_seq;
DROP SEQUENCE episode_seq;
DROP SEQUENCE qna_seq;

CREATE SEQUENCE qna_seq;
CREATE SEQUENCE book_seq;
CREATE SEQUENCE review_sns_seq;
CREATE SEQUENCE member_seq;
CREATE SEQUENCE subscription_seq;
CREATE SEQUENCE shipment_seq;
CREATE SEQUENCE comment_table_seq;
CREATE SEQUENCE novel_seq;
CREATE SEQUENCE episode_seq;